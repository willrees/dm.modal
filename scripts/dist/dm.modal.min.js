dm.globalComponentFactory("modal",function(a,b){function c(){b(".dm-modal").removeClass("open").attr("aria-hidden",!0),g()}function d(b){return a.get(b)}function e(a){b(".dm-modal .dm-modal-body").empty(),b(".dm-modal .dm-modal-body").html(a),b(".dm-modal").addClass("open").attr("aria-hidden",!1)}function f(){g();var a=b(document),c=this;c.settings.closeOnOverlay&&(a.on("click.dm-modal",".dm-modal",function(a){c.close()}),a.on("click.dm-modal-body",".dm-modal-body",function(a){a.preventDefault(),a.stopPropagation()})),c.settings.closeOnEscape&&a.on("keyup.closeOnEscape",function(a){27===a.keyCode&&c.close()})}function g(){var a=b(document);a.off("click.dm-modal"),a.off("click.dm-modal-body"),a.off("keyup.closeOnEscape")}var h=dm.config.modal,i=b("body"),j=function(){return void 0!==h.modalTemplate?h.modalTemplate:a.get(h.modalTemplateUrl())},k=function(a){i.append(a)};!function(){void 0===h.modalTemplate?j().done(function(a){k(a)}):k(h.modalTemplate())}();var l={content:"",closeOnEscape:!0,closeOnOverlay:!0},m=function(a){var b=l,c=this;this.settings=jQuery.extend(!0,{},b,a),console.log(this.settings),"object"==typeof this.settings.content?void 0!==this.settings.content.url&&this.settings.content.preload===!0&&d(this.settings.content.url).done(function(a){c.content=a}):"string"==typeof this.settings.content&&(this.content=this.settings.content)};m.prototype.open=function(){void 0===this.content?(b(".dm-modal").addClass("loading"),d(this.settings.content.url).done(function(a){e(a),b(".dm-modal").removeClass("loading")})):e(this.content),f.apply(this)},m.prototype.close=function(){c()};var n={create:function(a){return new m(a)}};return b(function(){b('[data-dm-modal="true"]').each(function(){var a=b(this),c={closeOnEscape:void 0===a.data("dm-modal-closeonescape")?!0:a.data("dm-modal-closeonescape"),closeOnOverlay:void 0===a.data("dm-modal-closeonoverlay")?!0:a.data("dm-modal-closeonoverlay")};void 0!==a.data("dm-modal-content-id")?c.content=b("#"+a.data("dm-modal-content-id")).html():void 0!==a.data("dm-modal-content-url")&&(c.content={url:a.data("dm-modal-content-url"),preload:void 0===a.data("dm-modal-preload")?!0:a.data("dm-modal-preload")});var d=jQuery.extend(!0,l,c);a.data("dm-modal",n.create(d)),a.on("click",function(a){a.preventDefault();var c=b(this);c.data("dm-modal").open()})}),b(document).on("click",'[data-dm-modal-close="true"]',function(){c()})}),n},{modalTemplate:void 0,modalTemplateUrl:function(){return dm.config.basePath+"/templates/modal.html"}},function(){return[dm.http,jQuery]});